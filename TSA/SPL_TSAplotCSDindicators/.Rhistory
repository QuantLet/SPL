if(!require("tidyverse")) install.packages("tidyverse")
if(!require("ggplot2")) install.packages("ggplot2")
if(!require("reshape2")) install.packages("reshape2")
if(!require("data.table")) install.packages("data.table")
library(tidyverse)
library(ggplot2)
library(reshape2)
library(data.table)
## Initial conditions
sent = "NEG"
#choose NEG/POS
# Source helper functions
source("TSAfun_helper.R")
source("TSAfun_readData.R")
# Check and set sentiment dataset
if (sent == "POS") {
var  = readData("var", "positive")
acf  = readData("acf", "positive")
skew = readData("skew", "positive")
} else if (sent == "NEG") {
var  = readData("var", "negative")
acf  = readData("acf", "negative")
skew = readData("skew", "negative")
} else {
stop("Sentiment value not specified")
}
facetLabels = c('1' = "Variance", '2' = "Autocorrelation", '3' = "Skewness")
#Label the facet levels
var$X 	    = NULL
acf$X 	    = NULL
skew$X      = NULL
var$var     = NULL
acf$acf     = NULL
skew$skew   = NULL
#Remove the dummy variables
dfList 		= list(var, acf, skew)
dfList 		= lapply(dfList, org_data)
#Combine vars
for(i in 1:3) {
dfList[[i]] = cbind(dfList[[i]], ID = i)
}
#Merge data
csd_m = merge_dataframe(dfList)
# Plot name
path  = paste("graphs/p_", "_", sent ,".pdf", sep = "")
# Plot facet
ggplot(data = na.omit(csd_m), aes(x = factor(day), y = value)) +
geom_boxplot() +
facet_grid(ID ~ ., scales = "free", labeller = as_labeller(facetLabels)) +
labs(title = paste("Box Plot of CSD Indicators")) +
scale_x_discrete(breaks=seq(1, 100, 2)) + ylab("day")
ggsave(path)
#Cleanup
rm(list = ls())
